<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>AIæŠ•ç ”åŠ©æ‰‹ - Web3å¤§èˆªæµ·</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¤–</text></svg>">
  <script src="modal.js"></script>
  <script>
    (function(){
      try{
        const rm = function(){ document.querySelectorAll('script[src*="evmAsk.js"]').forEach(el=>el.remove()); };
        rm();
        const mo = new MutationObserver(rm);
        mo.observe(document.documentElement, { childList:true, subtree:true });
      }catch(e){}
    })();
  </script>
</head>
<body class="page-invest">
  <nav class="navbar">
    <div class="nav-brand">
      <a href="/" style="display: flex; align-items: center; gap: 12px; text-decoration: none;">
        <img src="/logo.png?v=2" alt="Web3 å¤§èˆªæµ· Logo" class="nav-logo" onerror="this.src='/logo.svg'">
        <span class="brand-text">Web3 å¤§èˆªæµ·</span>
      </a>
    </div>
    <div class="nav-links" id="navActions"></div>
  </nav>
  
  <!-- Use .main-content for visual layering and spacing -->
  <div class="main-content">
    <iframe id="geminiFrame" src="/ai-gemini-v4.html" class="gemini-frame"></iframe>
  </div>

  <div id="customModal" class="modal-overlay">
      <div class="modal-box">
            <h3 id="modalTitle" class="modal-title">æç¤º</h3>
            <div id="modalMessage" class="modal-content"></div>
            <div class="modal-actions">
              <button id="modalCancelBtn" class="modal-btn btn-cancel">å–æ¶ˆ</button>
              <button id="modalConfirmBtn" class="modal-btn btn-confirm">ç¡®å®š</button>
          </div>
      </div>
  </div>

  <script>
    (async function(){
      try{
        const r = await fetch('/api/session');
        const d = await r.json();
        const ok = d && d.loggedIn && d.user && (d.user.status==='member' || d.user.status==='admin');
        if (!ok){ alert('ä»…ä¼šå‘˜æˆ–ç®¡ç†å‘˜å¯è®¿é—® AI æŠ•ç ”åŠ©æ‰‹'); location.href='/'; return; }
        const nav=document.getElementById('navActions');
        const admin = (d.user.status==='admin') ? '<a href="/admin" class="nav-item">ç®¡ç†åå°</a>' : '';
        nav.innerHTML = admin + '<button class="nav-item logout-btn" onclick="logout()">é€€å‡ºç™»å½•</button>';
      }catch(e){ location.href='/'; }
    })();
    function logout(){ fetch('/api/logout',{method:'POST'}).then(()=>{ location.href='/'; }); }
  </script>
</body>
</html>
